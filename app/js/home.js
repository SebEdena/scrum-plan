"use strict";const{ipcRenderer:ipcRenderer}=require("electron"),remote=require("electron").remote,{dialog:dialog}=remote.require("electron");$(document).ready(e=>{function t(t){let o=e.parseHTML(`\n            <div class="row mt-3 project" id='pj${t.id}'>\n            <div class="col-sm-9">\n            <div class="row"><h5 id='title'>${t.title}</h5></div>\n            <div class="row offset-md-1" id='desc'>${t.description}</div>\n            </div>\n            <div class="col-sm-3 text-center"><a role="button" class="btn btn-success btn-sm">Open</a></div>\n            </div>\n            `);e(o).find("a").data("project_id",t.id),e("#html_open_project").append(e(o)),e(o).find(".btn-success").on("click",t=>{e("#modal_open_project").modal("hide"),e("#create, #open").off("click"),ipcRenderer.send("open_project",{id:e(t.target).data("project_id")})})}ipcRenderer.send("fetch",{type:"projects"}),ipcRenderer.on("fetched",(o,r)=>{if(!r.ret)switch(r.type){case"projects":!function(){let o=remote.getGlobal("data").projects;if(e("#html_open_project").html(""),0!==o.length)for(let e in o)t(o[e]);else e("#html_open_project").append("<h5>No project found.</h5>")}()}}),e("#open").on("click",()=>{e("#modal_open_project").modal("show")}),e("#create").on("click",()=>{e("#modal_create_project").modal("show")}),e("#modal_create_project").on("hidden.bs.modal",()=>{e("#create_pj_form").find("textarea,input").val("")}),e("#create_pj_form").on("submit",t=>{t.preventDefault();let o={};o.title=e("#input_pj_name").val(),o.description=e("#input_pj_desc").val(),ipcRenderer.send("create",{type:"project",data:o}),e("#modal_create_project").modal("hide")}),ipcRenderer.on("insert",(e,o)=>{switch(String(o.type)){case"projects":t(o.data)}}),ipcRenderer.on("update",(t,o)=>{"projects"===o.type&&function(t){let o=remote.getGlobal("data").projects[t];e("#pj"+t).find("#title").text(o.title),e("#pj"+t).find("#desc").text(o.description)}(o.data.id)}),ipcRenderer.on("created",(e,t)=>{!function(e){if("project"===e.kind)if("ok"===e.status){let t={title:"Scrum Assistant",type:"info",buttons:["Ok"]};t.message='The project "'+e.data.title+'" has been created successfully !',dialog.showMessageBox(t)}else{let t={title:"Scrum Assistant",type:"error",buttons:["Retry","Cancel"]};t.message='The project "'+e.data.title+'" could not be created.',dialog.showMessageBox(t,t=>{0===t&&ipcRenderer.send("create",{type:"project",data:{title:e.data.title,description:e.data.description}})})}}(t)})});